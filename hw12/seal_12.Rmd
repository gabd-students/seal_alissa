---
title: "HW12: Dates"
author: "Alissa Seal"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

### Load Libraries
```{r}
library(tidyverse)
library(here)
library(lubridate)
```

### Part 1: Play date

## Load personal birth_date chunk
```{r}
seal <- "November 2, 1985"
seal1 <- mdy(seal)
seal1
```

### Question 1

##Elizabeth Anderson
```{r}
anderson <- "9 June 1836"
anderson1 <- dmy(anderson)
anderson1
```

##Mary Anning
```{r}
anning<- "1799/05/21"
anning1<- ymd(anning)
anning1
```

##Alice Ball
```{r}
ball<- "July 24, 1892"
ball1 <-mdy (ball)
ball1
```

## Sylvia Earle
```{r}
earle <- "August, 30 (1935)"
earle1 <-mdy(earle)
earle1
```

## Rosalind Franklin
```{r}
franklin<- "25th of July, 1920"
franklin1 <- dmy(franklin)
franklin1
```

## Ester Lederberg
```{r}
lederberg <- "December 18, 1922"
lederberg1 <- mdy(lederberg)
lederberg1
```

## Barbara McClintock
```{r}
mcclintock <- "16061902"
mcclintock1 <- dmy(mcclintock)
mcclintock1
```

## MLK_birth

```{r}
mlk_birth <- "1/15/29"
mlk_birth1 <- mdy(mlk_birth)
year(mlk_birth1) <- 1929
mlk_birth1
```

## MLK_dream
```{r}
mlk_dream <- "1963 August 28"
mlk_dream1 <- ymd(mlk_dream)
mlk_dream1
```

### Question 3
## Weekday of birth
```{r}
weekdays(seal1)
```

### Question 4
## Weekday of birthday this year
```{r}
update(seal1, year=2020, month=11, day=02) %>%
  weekdays()
```

### Question 5
## Weekday of birthday year 2525
```{r}
update(seal1, year=2525, month=11, day=02) %>%
  weekdays(abbr=TRUE)
```

## Set 2525 Birthday
```{r}
birthday <- "November 02, 2525"
birthday2525 <- mdy(birthday)
```

## How Old In 2525
```{r}
(birthday2525-seal1) / 365
```
## The return code proveds an answer in days, but dividing by 365 converts the answer to years. I would be 540 years old in 2525. 


### Question 6

## Number of days between the birth of Dr. Anderson and Ball

```{r}
ball1-anderson1
```

### Question 7

## Duration between Martin Luther King Jr's birthday and his speech
```{r}
mlk_dream1-mlk_birth1
```

### Create birth dates vector

```{r}
birth_dates <- c(anderson1, anning1, ball1, earle1, franklin1, lederberg1, mcclintock1, mlk_birth1, seal1)
```

### check for leap years
```{r}
birth_dates[leap_year(birth_dates)] %>%
  year()
```

### Days between my birthday and the others in the birth_dates dataset

```{r}
seal1-birth_dates
```

### Part 2: Wrangling and plotting with dates

## Import lake_ice Data
```{r}
lake_ice_raw <- read.csv(here("data", "lake_ice.csv"), na.strings="-999") %>%
  na.omit()
lake_ice_raw
```

## Filter out Lake Mendota
```{r}
lake_mendota_data <- filter(lake_ice_raw, lakename== "LAKE MENDOTA") 
```

## Select six columns, make new date columns, create new duration column with values as numerics
```{r}
lake_mendota_data_2 <- select(lake_mendota_data, iceon_year, iceon_month, iceon_day, iceoff_year, iceoff_month, iceoff_day) %>%
  mutate(ice_on = make_date(iceon_year, iceon_month, iceon_day) ,ice_off = make_date(iceoff_year, iceoff_month, iceoff_day), duration_days = as.numeric(ice_off-ice_on))


```


## Create a line graph of ice data
```{r}
ggplot(data = lake_mendota_data_2)+
  geom_line(mapping = aes(x=iceoff_year, y=duration_days))+xlab("Year")+ylab("Duration of Ice/Days")


```
## na values were removed from data when imported

### Soil Carbon Dioxide

## Import soil_co2 Dataset

```{r}
soil_co2_data <- read_tsv(here("data", "soil_co2.txt"))
```
```{r}
soil_co2_data
```

## POSIXct- compatiable date variable for 1/1/06

```{r}
date <- "01, January 2006"
date1 <- dmy(date)
date1
```

## Rename columns
```{r}
soil_co2_data_2 <- soil_co2_data %>%
  rename("Day" = "DayN[]", "Date_code" = "Datecode[]",  "Min" = "Min[]", "Veg" = "Veg[]", "Plot" = "Plot[]", "Group" = "Group[]", "Corr_CO2" = "CorrCO2[]", "Soil_T" =  "SoilT[]")
```

### load lubridate
```{r}
library(lubridate)
```
#### Make a new date column add date vector to day column
```{r}
mutated_soil_co2<-soil_co2_data_2 %>%
 mutate(Date=(Day+date1))
mutated_soil_co2
```

### Create year and month column
```{r}
mutated_soil_co2_2 <- mutated_soil_co2 %>%
  mutate(Year=year(Date), Month=month(Date))
mutated_soil_co2_2
```

### Group data by year and month
```{r}
soil_co2_ym <- group_by(mutated_soil_co2_2,Year, Month)
soil_co2_ym
```
```{r}
source(here("scripts","my_functions.R"))
```

### Summarize CO2 mean
```{r}
summarized_soil_co2_ym <- summarise(soil_co2_ym, co2_mean=mean(Corr_CO2, na.rm = TRUE), std_err_co2=std_err (Corr_CO2, na.rm = TRUE))
```

### Summarize CO2 mean
```{r}
summarized_soil_co2_ym <- summarise(soil_co2_ym, co2_mean=mean(Corr_CO2, na.rm = TRUE), std_err_co2=std_err(Corr_CO2, na.rm = TRUE))
summarized_soil_co2_ym
```

### Mean CO2 Column Chart
```{r}
ggplot(data=summarized_soil_co2_ym)+
  geom_col(mapping = aes(x=Month, y=co2_mean))+
  geom_errorbar(aes(x=Month,ymin=co2_mean-std_err_co2,ymax=co2_mean+std_err_co2), width = .3)+
  facet_wrap(~Year)
```

********* POSSIBLE WAYS TO CHANGE MONTH NAMES
scale_x_continuous(breaks = month_numeric, 
                    labels = month_label)

xlab("Month")

### Mean CO2 Point Chart using geom_linernange
```{r}
ggplot(data=summarized_soil_co2_ym)+
  geom_point(mapping = aes(x=Month, y=co2_mean))+
  geom_linerange(aes(x=Month,ymin=co2_mean-std_err_co2,ymax=co2_mean+std_err_co2), width = .3)+
  facet_wrap(~Year)
```




### Import Thebes Data
```{r}
raw_thebes <- read_csv(here("data", "thebes_discharge.csv"))
raw_thebes
```

### Tidy the Thebes Data
```{r}
thebes_tidy <- raw_thebes %>%
  pivot_longer("1988":"2018",
               names_to = "Year",
               values_to = "Discharge")
thebes_tidy
```

### Group by year and month
```{r}
thebes_tidy_grouped <- thebes_tidy %>% group_by(Year, Month)
thebes_tidy_grouped
```

### Summarize the mean discharge
```{r}
thebes_tidy_grouped %>%
  summarise(count = n(), Discharge = mean(Discharge, na.rm = TRUE))
```







