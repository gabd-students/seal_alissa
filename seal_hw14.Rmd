---
title: "HW14: Maps"
author: "Alissa Seal"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

### Import Data
```{r}
library(here)
library(raster)
library(sf)
library(tidyverse)
library(ggthemes)
library(patchwork)
library(maptools)
library(ggmap)
library(marmap)
```

### Part 1: Outline Maps

## Outline of the 48 contiguous states
```{r}
usa <- map_data(map= "state")
```

## Outline of just Missouri
```{r}
us_missouri <- map_data (map = "state",
                         region = "missouri")
```

## Outline of Alabama, Florida, Mississippi, and North Carolina
```{r}
us_other <- subset(x= usa, 
                   subset= region %in% c("alabama",
                                         "florida",
                                         "mississippi",
                                         "north carolina"))
```

```{r}
str(usa)
```

## Map of 4 non-Missouri states
```{r}
ggplot()+
  geom_polygon(data = us_other, 
               aes(x=long, 
                   y= lat,
                   group=group),
               fill= "gray")
```

## Add Missouri with emphasis 
```{r}
ggplot() +
geom_polygon(data = us_other,
             aes(x = long,
                 y = lat,
                 group = group),
             fill = "gray") +
geom_polygon(data = us_missouri,
             aes(x = long, y = lat,
                 group = group),
             fill = "black")
```

## Outline of all 48 states
```{r}
ggplot() +
geom_polygon(data = us_other,
             aes(x = long,
                 y = lat,
                 group = group),
             fill = "gray") +
geom_polygon(data = us_missouri,
             aes(x = long, y = lat,
                 group = group),
             fill = "black") +
geom_polygon(data = usa,
             aes(x=long,
                 y = lat,
                 group = group),
             fill = NA,
             color = "black")
```
## Add the filled states first so that the black outline of all
## States are overlaid on top
```{r}
us_map <- ggplot() +
geom_polygon(data = us_other,
             aes(x = long,
                 y = lat,
                 group = group),
             fill = "gray") +
geom_polygon(data = us_missouri,
             aes(x = long, y = lat,
                 group = group),
             fill = "black") +
geom_polygon(data = usa,
             aes(x=long,
                 y = lat,
                 group = group),
             fill = NA,
             color = "black") +
theme_map() +
coord_fixed(1.3)
us_map
```

## Missouri Map
```{r}
missouri <- map_data("county", "missouri")
mo_scott <- subset(missouri, subregion %in% c("scott"))
mo_map <- ggplot() +
geom_polygon(data = missouri, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = mo_scott, aes(x = long, y = lat, group = group), fill = "black") +
theme_map() +
coord_fixed(1.3)
mo_map
```

## us_map and a mo_map side by side
```{r}
us_map + mo_map + plot_layout(ncol = 2, widths = c(1.5,1))
```







### Outline Maps: My Turn

## Outline of the 48 contiguous states
```{r}
usa <- map_data(map= "state")
```

## Outline of just Arkansas
```{r}
us_arkansas <- map_data (map = "state",
                         region = "arkansas")
```


## U.S. map should highlight in black the state of your birth
```{r}
us_map <- ggplot() +
geom_polygon(data = us_arkansas,
             aes(x = long, y = lat,
                 group = group),
             fill = "black") +
geom_polygon(data = usa,
             aes(x=long,
                 y = lat,
                 group = group),
             fill = NA,
             color = "black") +
theme_map() +
coord_fixed(1.3)
us_map
```

## State map highlighting the county of your birth
```{r}
arkansas <- map_data("county", "arkansas")
ar_greene <- subset(arkansas, subregion %in% c("greene"))
ar_map <- ggplot() +
geom_polygon(data = arkansas, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = ar_greene, aes(x = long, y = lat, group = group), fill = "black") +
theme_map() +
coord_fixed(1.3)
ar_map
```

## Outline other counties
```{r}
ar_other_counties <- subset(x= us_arkansas, subregion %in% c("arkansas","sharp"))
```



## Two additional counties in gray
```{r}
arkansas <- map_data("county", "arkansas")
ar_greene <- subset(arkansas, subregion %in% c("greene"))
ar_other_counties <- subset(arkansas, subregion %in% c("arkansas", "sharp"))
ar_map_counties <- ggplot() +
geom_polygon(data = ar_other_counties, aes(x=long, y = lat, group = group), fill = "gray") +
geom_polygon(data = arkansas, aes(x=long, y = lat, group = group), fill = NA, color = "black") +
geom_polygon(data = ar_greene, aes(x = long, y = lat, group = group), fill = "black") +
theme_map() +
coord_fixed(1.3)
ar_map_counties
```

### Part 2: Choropleth Maps

## Load Libraries
```{r}
library(sf)
library(tidyverse)
```

## Import skin cancer data
```{r}
skin_cancer_raw <-read_delim(file = here::here("data","hw14_data","skin_cancer.txt"),
delim = " ",
skip = 7,
trim_ws = TRUE)
```
## Wrangle the Data

```{r}
skin_cancer <- skin_cancer_raw %>%
filter(State != "Wash,D.C.") %>%
mutate(State = case_when(
State == "NorthCarolina" ~ "North Carolina",
State == "SouthCarolina" ~ "South Carolina",
State == "NorthDakota" ~ "North Dakota",
State == "SouthDakota" ~ "South Dakota",
State == "NewHampshire" ~ "New Hampshire",
State == "NewJersey" ~ "New Jersey",
State == "NewMexico" ~ "New Mexico",
State == "MewYork" ~ "New York", # Data has MewYork typo
State == "RhodeIsland" ~ "Rhode Island",
State == "WestVirginia" ~ "West Virginia",
TRUE ~ State))
skin_cancer
```

## Calculate mortality rate to the mean rate
```{r}
mean_mort <- mean(skin_cancer$Mort)
```
```{r}
skin_cancer_adj <- skin_cancer %>%
mutate(relative_mort = Mort - mean_mort)
mean_mort
```

# Trim Alaska, Hawaii, and territories from the shapefile.
```{r}
lower_48 <- c("Alabama","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida")
```

## Use filter() to keep only states in the states object that listed in the lower_48 vector
```{r}
states <- st_read(here::here("data", "hw14_data/shape_files", "cb_2017_us_state_500k.shp"),
stringsAsFactors = TRUE)
```

```{r}
states_df <- states %>%
dplyr::filter(NAME %in% lower_48)
```

